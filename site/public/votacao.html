<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/votacao.css">
    <link rel="stylesheet" href="css/cards.css">
    <title>Only Drama</title>
</head>
<body>
<!--menu fixo lateral-->

<div class="navbar">
    <div class="logo">
        <a href="index.html"><img src="img/only_drama.png"></a>
    </div>
    <div class="cont">
        <ul class="lista1">
            <li><a href=""><img src="img/home-full.png"></a><a class="a" href="Home.html">Home</a></li>
        </ul>
        <ul class="lista2">
            <li><a href=""><img src="img/star.png" alt=""></a><a class="a" href="favoritos.html">Favoritos</a></li>
            <li><a href=""><img src="img/relogio-sete.png" alt=""></a><a class="a" href="rescente.html">Recentes</a></li>
            <li><a href=""><img src="img/musica.png" alt=""></a><a class="a" href="">Musica</a></li>
            <li><a href=""><img src="img/stats.png" alt=""></a><a class="a" href="">Votação</a></li>
        </ul>
        <ul class="lista3">
            <li><a href=""><img src="img/configuracao.png" alt=""></a><a class="a" href="Setting">Setting</a></li>
            <li><a href=""><img src="img/ajuda.png" alt=""></a><a class="a" href="Help">Help</a></li>
        </ul>
    </div>
</div>


<!-- Votação -->

    <div class="container1">
        <h2>Vote no seu Drama preferido</h2>
        <div class="conjunto1">
            <div class="indicacoes">
                <div class="cards">
                    <div class="opcao1">
                        <div class="card img1" id="1"></div>
                        <label>Descendentes do Sol</label><input type="checkbox" id="drama1_input">
                    </div>
                    <div class="opcao2">
                        <div class="card  img2" id="2"></div>
                        <label>W Two Words</label><input type="checkbox" id="drama2_input">
                    </div>
                    <div class="opcao3">
                        <div class="card  img3" id="3"></div>
                        <label>Run On</label><input type="checkbox" id="drama3_input">
                    </div>
                </div>
            </div>
        </div>

        <button onclick="votar()">Votar</button>
    </div>
    
</body>
</html>
<script>

    votacaoDrama = {
        drama1: [],
        drama2: [],
        drama3: []
    }
    function validacao(){

    }

    function votar(){
        var idUsuario = sessionStorage.ID_USUARIO;

        if(drama1_input.value != ""){
            var dramaVar = drama1_input.value;
        }else if(drama2_input.value != ""){
            var dramaVar = drama2_input.value;
        }else{
            var dramaVar = drama3_input.value;
        }

        if(drama1Var == "" || drama2Var == "" || drama3Var == ""){
            return false
            alert('Você precisa votar em algum Drama para prosseguir')
        }else{
            fetch(`/votacao/inserir${idUsuario}`,{
                method: "POST",
                headers:{
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora vá para o arquivo routes/usuario.js
                    dramaServer: dramaVar,
                })
            }).then(function(resposta){
                if(resposta.ok){
                    alert('Votação realizada com sucesso')
                    window.location = ''
                }else{
                    throw("Houve um erro ao tentar realizar o cadastro!");
                    alert('Houve um erro ao realizar a votação por favor tente novamente')
                }
            });

            return false
        }
    }

</script>